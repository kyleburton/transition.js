<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Transition.js : Detangled in-Browser Webapp Testing" />

    <link rel="stylesheet" type="text/css" media="screen" href="/transition.js/site/stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/transition.js/site/css/transition.js.css">
    <link rel="stylesheet" type="text/css" media="screen" href="/transition.js/site/css/pygments.css">

    <title>Documentation</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/kyleburton/transition.js/">View on GitHub</a>

          <h1 id="project_title"><a href="/transition.js/2.0">Transition.js 2.0</a></h1>
          <h2 id="project_tagline">Detangled in-Browser Webapp Testing</h2>

          

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">

      

      <section id="main_content" class="inner">
      <ul>
	<li><a href="#rationale">Rationale</a></li>
	<li><a href="#test-runner">Test Runner UI</a>
	<ul>
		<li><a href="#test-log">Log</a></li>
		<li><a href="#controls">Controls</a></li>
		<li><a href="#setings">Settings</a></li>
		<li><a href="#defining-a-test-suite">Defining a Test Suite</a></li>
		<li><a href="#defining-tests">Defining Tests</a></li>
	</ul></li>
	<li><a href="install/">Installation</a></li>
	<li><a href="getting-started/">Getting Started</a></li>
	<li><a href="api/">Transition.js <span class="caps">API</span></a></li>
</ul>
<p><a name="rationale"></a></p>
<h2>Rationale</h2>
<p>Transition.js was created to address specific issues I was having with trying to test my websites on Mobile and Tablet devices.</p>
<p>The websites I needed to test were invariably asynchronous.  This lead to writing tests that poll and wait for asynchronous events to complete.  Detecting when events completed was error-prone.  The tests were brittle and would fail inconsistently due to timing issues.</p>
<p>I wanted a test suite that drove the user interface of the website as close to how a user would.  Not just a framework that would test the underlying JavaScript code at the unit level.</p>
<p>I wanted a solution that would execute a test suite on mobile devices (phones and tablets).</p>
<p>At the time I started Transition.js there was no tool or framework that I knew of that fit this criteria.</p>
<h3>Inverting the need to Poll</h3>
<p>Since waiting for a condition to become true before continuing was a core part of the tests I was writing, I made the idea of waiting core to the testing framework.  The most natural way of expressing this for me was to implement tests as a <a href="http://en.wikipedia.org/wiki/Finite-state_machine">State Machine</a>.</p>
<p>Each test has a name, an optional `initialize` function and a list of states.  Each state has a name, an initializer, and defines the set of transitions to subsequent states.  A transition consists of the name of the target state and a predicate function.</p>
<p>When a test is run by Transition.js, the framework will call the test&#8217;s initializer, then:</p>
<ul>
	<li>transition to the first state of the test</li>
	<li>call the initializer for the first state</li>
	<li>try each of the current state&#8217;s transitions</li>
</ul>
<p>If a predicate returns true, then the target state will be transitioned to.  If no predicates return true, the framework will set a timeout (default is 250ms) before trying again.  If the test takes more than a pre-set maximum (default 30s), then the test is considered failed.  If it reaches a success state before the timeout, it is considered passed.</p>
<p><a name="test-runner"></a></p>
<h1>The Runner UI</h1>
<h2>Test Suite</h2>
<p>The &#8216;Suite&#8217; menu allows you to select a test to run, optionally by first filtering the list.  You may also reload your test suite.  Reloading does not effect the state of the Runner UI and is an effective tool when developing and debugging your tests.</p>
<p><a name="test-log"></a></p>
<h2>The Test Log</h2>
<p>Transition.js has a logging system that logs to the Runner UI instead of the browser&#8217;s debug console.  The browser&#8217;s debug console is often either not visible on some devices, difficult to enable or not fully featured.  The Transition.js logger is visible, supports searching (filtering) and setting different levels of output.</p>
<p><a name="controls"></a></p>
<h2>Test Controls</h2>
<p>There are several control buttons in the runner UI:</p>
<ul>
	<li>Run Suite: this starts a full run of the suite from the first test.</li>
	<li>Start: starts the currently selected test, or the first test in the suite if none is selected.</li>
	<li>Stop: this will halt the currently running test or full suite.</li>
	<li>Step: stepping allows you to walk through your test one poll at a time so you can observe what it is doing.</li>
	<li>Back: if you are single-stepping a test, the Back button will move back a state (executing its trigger function)</li>
	<li>Continue: if you have single-stepped a test, Continue will start the polling process so the test continues to run automatically.</li>
</ul>
<p><a name="settings"></a></p>
<h2>Settings</h2>
<p>Some settings can be changed via the test runner&#8217;s UI.  Settings that are not exposed through the UI can be set from your <code>test-suite.js</code>:</p>
<div class="highlight"><pre><code class="javascript"><span class="c1">// in test-suite.js</span>
<span class="nx">Transition</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;pollTimeout&#39;</span><span class="p">,</span> <span class="mi">250</span><span class="p">);</span>
<span class="nx">Transition</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;logLevel&#39;</span><span class="p">,</span>    <span class="nx">Transition</span><span class="p">.</span><span class="nx">Log</span><span class="p">.</span><span class="nx">Levels</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">);</span>

<span class="c1">// load your scripts here</span>
<span class="c1">// Transition.loadScript(&#39;/test/test-name.js&#39;);</span>
</code></pre>
</div>
<h5>int: <code>frame-divider-upper-pct</code> default=50</h5>
<h5>int: <code>frame-divider-lower-pct</code> default=50</h5>
<p>These control the location of the divider between the main and test frames in the runner UI.</p>
<h5>boolean: <code>sortByLastModified</code> default=true</h5>
<p>If set to true, when tests are loaded via <code>loadScript</code>, the test suite will be ordered in reverse by time.  The most recently modified test will be first, while The least recently modified will be last.</p>
<h5>miliseconds: <code>perStateTimeout</code> default=10000</h5>
<p>If a test stays in a single state for longer than this amount of time, the test will be marked as failed.</p>
<h5>miliseconds: <code>testTimeout</code> default=30000</h5>
<p>If a test takes longer than this amount of time, the test will be marked as failed.</p>
<h5>miliseconds: <code>suiteTimeout</code> default=60000</h5>
<p>If the test suite takes longer than this amount of time, the suite will fail.</p>
<h5>miliseconds: <code>pollTimeout</code> default=500</h5>
<p>This is the amount of time the framework will wait before checking the test&#8217;s current state to see if it should proceed to a subsequent state.</p>
<h5>enum: <code>logLevel</code> default=Transition.Log.Levels.<span class="caps">TRACE</span></h5>
<p>This controls the verbosity of the log display.  This value can also be adjusted via the Log drop-down menu. The following log levels are supported:</p>
<p>1. <span class="caps">TRACE</span><br />
2. <span class="caps">DEBUG</span><br />
3. <span class="caps">INFO</span><br />
4.. <span class="caps">WARN</span><br />
5. <span class="caps">ERROR</span><br />
6. <span class="caps">FATAL</span></p>
<p><a name="defining-a-test-suite"></a></p>
<h1>Defining a Test Suite</h1>
<p>After creating the symbolic link to the Transition.js <code>public</code> directory, your next step is to define your test suite.  You do this in the file <code>test-suite.js</code> in the same place you created the symbolic link:</p>
<div class="highlight"><pre><code class="bash">public/
  +-- transition -&gt; ~/projects/transition.js/public
  +-- <span class="nb">test</span>-suite.js
  +-- tests
      +-- add-a-list.js
      +-- add-todo-item.js
      +-- index-page.js
      +-- mark-item-as-done.js
</code></pre>
</div>
<p>Tests can be defined within the <code>test-suite.js</code> file directly, or in separate files.  Best practice is to place utility code for testing your application in the test-suite.js and then each test in its own file:</p>
<div class="highlight"><pre><code class="javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">root</span>        <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
      <span class="nx">TodoTestLib</span> <span class="o">=</span> <span class="p">{};</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">TodoTestLib</span> <span class="o">=</span> <span class="nx">TodoTestLib</span><span class="p">;</span>

  <span class="nx">TodoTestLib</span><span class="p">.</span><span class="nx">deleteTestList</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">};</span>

  <span class="nx">TodoTestLib</span><span class="p">.</span><span class="nx">createTestList</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">};</span>

<span class="p">}.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>

<span class="nx">Transition</span><span class="p">.</span><span class="nx">loadScript</span><span class="p">(</span><span class="s1">&#39;/tests/index-page.js&#39;</span><span class="p">);</span>
<span class="nx">Transition</span><span class="p">.</span><span class="nx">loadScript</span><span class="p">(</span><span class="s1">&#39;/tests/add-a-list.js&#39;</span><span class="p">);</span>
<span class="nx">Transition</span><span class="p">.</span><span class="nx">loadScript</span><span class="p">(</span><span class="s1">&#39;/tests/add-todo-item.js&#39;</span><span class="p">);</span>
<span class="nx">Transition</span><span class="p">.</span><span class="nx">loadScript</span><span class="p">(</span><span class="s1">&#39;/tests/mark-item-as-done.js&#39;</span><span class="p">);</span>
</code></pre>
</div>
<h1>Optinally Defining a <code>test-suite.html</code> for Static Content</h1>
<p>If your tests themselves require helper libraries or other static content (like their own UI controls, html, etc.), you can create a <code>test-suite.html</code> file next to <code>test-suite.js</code>.  The content of this file will be fetched and appended to the <code>&lt;body&gt;</code> <strong>before</strong> the <code>test-suite.js</code> file itself is loaded.</p>
<p><a name="defining-tests"></a></p>
<h1>Defining Tests</h1>
<p>Tests are added by calling <code>Transition.addTest</code>, passing an object of properties.</p>
<p>The test must have 2 properties:</p>
<ul>
	<li><code>name</code>: the name of the test</li>
	<li><code>states</code>: the set of states that comprise the test.</li>
</ul>
<p>Additional properties will become available as attributes on the Test model (available within your test with <code>this.get('attr')</code> and <code>this.set('attr', 'value')</code>).</p>
<p>Properties that are functions will be lifted to become methods on the Test model itself.  Be careful not to re-define any existing Backbone Model methods.</p>
<p>States are constructed with <code>Transition.newState</code>.  Each state must have:</p>
<ul>
	<li><code>name</code>: the name of the state</li>
	<li><code>on-enter</code> callback, which is called once, when the state is entered.</li>
	<li>one or more exit transitions, created with <code>to</code></li>
</ul>
<p>Here is an example that loads the root page of the example <span class="caps">TODO</span> application and asserts that the form for creating lists is present:</p>
<div class="highlight"><pre><code class="javascript"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

  <span class="k">this</span><span class="p">.</span><span class="nx">addTest</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;Test Index Page&#39;</span><span class="p">,</span>

    <span class="nx">states</span><span class="o">:</span> <span class="p">[</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">newState</span><span class="p">(</span><span class="s1">&#39;init&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">navigateTo_</span><span class="p">(</span><span class="s1">&#39;about:blank&#39;</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="s1">&#39;mainPage&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">constantly_</span><span class="p">(</span><span class="kc">true</span><span class="p">)),</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">newState</span><span class="p">(</span><span class="s1">&#39;mainPage&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">navigateTo_</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span>
        <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">).</span><span class="nx">when</span><span class="p">(</span><span class="s1">&#39;form[action=&quot;/lists&quot;]&#39;</span><span class="p">)</span>
    <span class="p">]</span>
  <span class="p">});</span>

<span class="p">}.</span><span class="nx">call</span><span class="p">(</span><span class="nx">Transition</span><span class="p">));</span>
</code></pre>
</div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Transition.js maintained by <a href="https://github.com/kyleburton">kyleburton</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

  </body>
</html>
